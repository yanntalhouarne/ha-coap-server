#
# Copyright (c) 2020 Nordic Semiconductor
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

# nRF board library
CONFIG_DK_LIBRARY=y
CONFIG_OPENTHREAD_NORDIC_LIBRARY_MASTER=y

#CONFIG_MAIN_STACK_SIZE=4069

# Enable OpenThread CoAP support API
CONFIG_OPENTHREAD_COAP=y

# Network shell
#CONFIG_SHELL=n
CONFIG_OPENTHREAD_SHELL=n
#CONFIG_SHELL_ARGC_MAX=26
#CONFIG_SHELL_CMD_BUFF_SIZE=416

# Network sockets
CONFIG_NET_SOCKETS=y
CONFIG_NET_SOCKETS_POSIX_NAMES=y
CONFIG_NET_SOCKETS_POLL_MAX=4

# Same network Master Key for client and server
# CONFIG_OPENTHREAD_NETWORKKEY="72:21:94:33:11:82:66:75:88:99:af:bc:fc:da:ea:de"
# CONFIG_OPENTHREAD_NETWORK_NAME="ha-coap-ot"
# CONFIG_OPENTHREAD_CHANNEL=15
# CONFIG_OPENTHREAD_PANID=4291
# CONFIG_OPENTHREAD_XPANID="17:85:30:19:46:62:66:16"
CONFIG_OPENTHREAD_JOINER_PSKD="J01NU5"
CONFIG_OPENTHREAD_JOINER=y
CONFIG_OPENTHREAD_JOINER_AUTOSTART=y

# Updatehub
# Disable default configs
CONFIG_BT=n
CONFIG_NET_L2_ETHERNET=n
CONFIG_NET_L2_IEEE802154=n

CONFIG_NET_IPV6_NBR_CACHE=n
CONFIG_NET_IPV6_MLD=n

# mbedTLS tweaks
CONFIG_MBEDTLS_SSL_MAX_CONTENT_LEN=768

# UpdateHub
CONFIG_MAIN_STACK_SIZE=8192
CONFIG_UPDATEHUB_COAP_BLOCK_SIZE_EXP=2


# L2 OpenThread enabling
CONFIG_NET_L2_OPENTHREAD=y

# Generic networking options
CONFIG_NETWORKING=y

CONFIG_MBEDTLS_SHA1_C=n
CONFIG_FPU=y

# ADC
CONFIG_ADC=y

# Fuel gauge
CONFIG_FUEL_GAUGE=y

# Temperature/Humidity sensor
CONFIG_SENSOR=y

# TOF
#CONFIG_DT_HAS_ST_VL53L0X_ENABLED=y
CONFIG_VL53L0X=y
CONFIG_VL53L0X_PROXIMITY_THRESHOLD=100
CONFIG_CBPRINTF_FP_SUPPORT=y

# IMU
#CONFIG_LSM6DSL_TRIGGER_GLOBAL_THREAD=y

# PWM
CONFIG_PWM=y

CONFIG_NEWLIB_LIBC_FLOAT_PRINTF=y

CONFIG_BOOTLOADER_MCUBOOT=y
#CONFIG_BOOT_SERIAL_CDC_ACM=y

# Enable MCUMGR 
CONFIG_MCUMGR=y

# Enable MCUMGR management for both OS and Images
CONFIG_MCUMGR_GRP_OS=y
CONFIG_MCUMGR_GRP_IMG=y

# Configure MCUMGR transport to UART
CONFIG_MCUMGR_TRANSPORT_UART=y

# Dependencies
# Configure dependencies for CONFIG_MCUMGR  
CONFIG_NET_BUF=y
CONFIG_ZCBOR=y
CONFIG_CRC=y

# Configure dependencies for CONFIG_MCUMGR_GRP_IMG  
CONFIG_FLASH=y
CONFIG_IMG_MANAGER=y

# Configure dependencies for CONFIG_IMG_MANAGER  
CONFIG_STREAM_FLASH=y
CONFIG_FLASH_MAP=y

# Configure dependencies for CONFIG_MCUMGR_TRANSPORT_UART 
CONFIG_BASE64=y

#CONFIG_USB_CDC_ACM = y
CONFIG_CONSOLE=y
# CONFIG_UART_CONSOLE_BAUDRATE=115200
# CONFIG_MCUMGR_TRANSPORT_UART_BAUDRATE=115200
CONFIG_USB_DEVICE_STACK=y
CONFIG_USB_DEVICE_REMOTE_WAKEUP=n
CONFIG_USB_DEVICE_MANUFACTURER="Yann T."
CONFIG_USB_DEVICE_PRODUCT="HA CoAp Device"
CONFIG_USB_DEVICE_VID=0x1915
CONFIG_USB_DEVICE_PID=0x0000
CONFIG_USB_DEVICE_INITIALIZE_AT_BOOT=n
CONFIG_SERIAL=y
CONFIG_UART_LINE_CTRL=n


#Example of product_uid, you must set you product uid.
CONFIG_UPDATEHUB_PRODUCT_UID="e4d37cfe6ec48a2d069cc0bbb8b078677e9a0d8df3a027c4d8ea131130c4265f"

#If you use the autorandler, need set UPDATEHUB_POLL_INTERVAL.
#This example, the updatehub will poll on the server
#request for updates one to one minute.
#(min: 0 minute, m√°x: 30 days)
CONFIG_UPDATEHUB_POLL_INTERVAL=1

CONFIG_UPDATEHUB_CE=y

#You need set the updatehub-ce ip Address.
#This is a example of ip address
CONFIG_UPDATEHUB_SERVER="192.168.50.225"


CONFIG_FLASH=y
CONFIG_STREAM_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_REBOOT=y
CONFIG_MCUBOOT_IMG_MANAGER=y
CONFIG_IMG_MANAGER=y
CONFIG_IMG_ENABLE_IMAGE_CHECK=y
#CONFIG_BOOTLOADER_MCUBOOT=y
CONFIG_MPU_ALLOW_FLASH_WRITE=y
CONFIG_NETWORKING=y
CONFIG_NET_UDP=y
CONFIG_NET_SOCKETS=y
CONFIG_COAP=y
CONFIG_DNS_RESOLVER=y
CONFIG_JSON_LIBRARY=y
CONFIG_HWINFO=y
CONFIG_POSIX_API=y

# Turn on the updatehub
CONFIG_UPDATEHUB=y
CONFIG_COAP_INIT_ACK_TIMEOUT_MS=10000

# Heap mem pool size
CONFIG_HEAP_MEM_POOL_SIZE=8192
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=8192

# Network events
CONFIG_NET_CONNECTION_MANAGER=y
CONFIG_NET_CONFIG_SETTINGS=y

CONFIG_NET_IPV6=n

CONFIG_NET_IPV4=y
CONFIG_NET_DHCPV4=y

# Enable Shell
# CONFIG_SHELL=y
# CONFIG_SHELL_STACK_SIZE=8192
# CONFIG_UPDATEHUB_SHELL=y
# CONFIG_NET_SHELL=y

# Debug helpers
#CONFIG_LOG=y
#CONFIG_UPDATEHUB_LOG_LEVEL_DBG=y

CONFIG_MAX_THREAD_BYTES=3
